<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" href="./img/Design_sem_nome__2_-removebg-preview.png">
  <link rel="stylesheet" href="./css/header.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300&display=swap" rel="stylesheet">
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="./css/cadastro.css" />
  <link rel="stylesheet" href="./css/footer.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tecnosolo - cadastro</title>
</head>

<body>
  <header class="cabecalho">
    <div class="container">
        <div class="div-logo">
            <a href="./index.html" target="blank" rel="noopener noreferrer"><img width="72px" src="./img/Design_sem_nome__2_-removebg-preview.png" alt="logo da empresa tecnosolo" class="logo"></a>
        </div>
        <nav class="navbar">
            <ul>
                <li><a href="./index.html">Home</a></li>
                <li><a href="./index.html#recursos-id">Recursos</a></li>
                <li><a href="./index.html#sobre-nos">Sobre nós</a></li>
                <li><a href="./index.html#suporte-id">Suporte</a></li>
                <li><a class="simulador" href="./calculadora_tecnosolo.html">Simulador</a></li>
               
            </ul>
        </nav>
        <div class="col-1">
            <ul>
                <li class="conta"><a class="conta" href="./Login.HTML">Conta</a></li>
                <ul>
        </div>
    </div>
</header>
  <div class="box">
    <img class="logo" src="./img/logoTomate.png" alt="" />
    <h2 class="titulo">Criar conta</h2>
    <div class="passosForm">
      <div class="circuloPassos">
          <p>1</p>
      </div>
      <div class="line"></div>
      <div class="circuloPassos" id="segundoPasso">
        <p id="numeroDois">2</p> 
      </div>
    </div>
    <div class="cadastro">
      <div id="direito" class="lado-direito">
        <p>E-mail:</p>
        <input type="email" id="iptEmail" placeholder="Insira o e-mail" required />
        <div class="mensagemErro" id="erroEmail" style="display: none;">
          E-mail inválido <br>
        </div>
        <p>Senha:</p>
        <input type="password" id="iptSenha" placeholder="Insira uma senha" required />
        <div class="mensagemErro" id="erroSenha" style="display: none;">
          Insira uma senha com pelo menos 8 dígitos <br>
          A senha deve ter pelo menos 1 caractere especial <br>
          A senha deve ter pelo menos uma letra maiúscula <br>
          A senha deve ter pelo menos uma letra minúscula
        </div>
        <p>Nome:</p>
        <input type="text" id="iptNome" placeholder="Insira seu nome" required />
        <p>CNPJ:</p>
        <input type="text" id="iptCnpj" placeholder="Insira o CNPJ" required />
        <div class="mensagemErro" id="erroCNPJ" style="display: none;">
          CNPJ inválido
        </div>
        <p>Telefone:</p>
        <input type="text" id="iptTelefone" placeholder="Insira seu telefone" required />
        <p>Nome da empresa:</p>
        <input type="text" id="iptRazaoSocial" placeholder="Insira o nome da Empresa" required />
      </div>
      <div id="esquerdo" class="lado-esquerdo">
        <p>CEP:</p>
        <input type="text" id="iptCep" placeholder="Insira o CEP" required />
        <div class="mensagemErro" id="erroCEP" style="display: none;">
          CEP inválido
        </div>
        <p>UF:</p>
        <input type="text" id="iptUF" placeholder="Insira o UF" required />
        <p>Cidade:</p>
        <input type="text" id="iptCidade" placeholder="Insira a cidade" required />
        <p>Bairro:</p>
        <input type="text" id="iptBairro" placeholder="Insira o bairro" required />
        <p>Rua:</p>
        <input type="text" id="iptRua" placeholder="Insira a rua" required />
        <p>Complemento:</p>
        <input type="text" id="iptComplemento" placeholder="Insira o complemento" />
      </div>
      <div class="div-botao" id="divBotao">
        <button id="botaoVoltar" style="display: none;" onclick="voltar()">Voltar</button>
        <button id="passoUm" onclick="passo1()">Avançar</button>
        <button id="cadastrarse" onclick="cadastrar()">Cadastrar</button>
      </div>
      
      <!-- <p style="color: white" id="mensagemErro"></p> -->
    </div>
  </div>

  <!-- BOTÃO NÃO FUNCIONAL E INPUT SEM TAMANHO FIXO -->
  <div class="footer">
    <div class="container-2">
      <div class="conheca-nos">
        <h5>Conheça-nos</h5>
        <p><a href="./index.html#sobre-nos">Sobre nós</a></p>
      </div>
      <div class="deixe-nos">
        <h5>Deixe-nos ajudar você</h5>
        <p><a href="./conta.html">Sua Conta</a></p>
        <p><a href="./index.html#suporte-id">Suporte</a></p>
      </div>
      <div class="contatos">
        <h5>Contatos</h5>
        <p><a href="http://instagra.com/tecnosolo_"> <img src="./img/Instagram.svg"></a></p>
        <p>E-mail:tecnosolo@gmail.com</p>
      </div>
      <div class="mais-informacoes">
        <h5>Gostaria de receber mais informações?</h5>
        <input type="text" id="email" placeholder="Seu e-mail aqui!">
      </div>
    </div>
    <div class="linha">
      <p>Condições de Uso | Notificação de Privacidade | Cookies | Anúncios baseados em interesses </p>
      <p>©2023. All Rights Reserved.</p>
    </div>
  </div>
</body>

</html>
<script>
  function passo1() {
    var email = iptEmail.value
    var senha = iptSenha.value
    var nome = iptNome.value
    var cnpj = iptCnpj.value
    var telefone = iptTelefone.value
    var razaoSocial = iptRazaoSocial.value


    var possui_especial =
      senha.indexOf('#') >= 0 ||
      senha.indexOf('@') >= 0 ||
      senha.indexOf('!') >= 0 ||
      senha.indexOf('%') >= 0 ||
      senha.indexOf('?') >= 0 ||
      senha.indexOf('-') >= 0 ||
      senha.indexOf('+') >= 0 ||
      senha.indexOf('_') >= 0;

    
    if (email.indexOf('@') >= 0 && (email.endsWith('.com') || email.endsWith('.br') || email.endsWith('.school'))) {
      erroEmail.style.display = 'none'
  
    }
    else {
      erroEmail.style.display = 'block';
      iptEmail.style.borderColor = 'red';
    }

    if (senha.length >= 8 && possui_especial && (senha != senha.toUpperCase() && senha != senha.toLowerCase())) {
      erroSenha.style.display = 'none'
    }
    else {
      erroSenha.style.display = 'block'
      iptSenha.style.borderColor = 'red'
    }

    if (cnpj.length == 14) {
      erroCNPJ.style.display = 'none'
    }
    else {
      erroCNPJ.style.display = 'block'
      iptCnpj.style.borderColor = 'red'
    }


    if (email.indexOf('@') >= 0 && (email.endsWith('.com') || email.endsWith('.br') || email.endsWith('.school')) && senha.length >= 8 && possui_especial && (senha != senha.toUpperCase() && senha != senha.toLowerCase()) && cnpj.length == 14) {
      direito.style.display = "none";
      esquerdo.style.display = "block";
      passoUm.style.display = "none";
      cadastrarse.style.display = "block";
      botaoVoltar.style.display = "block";
      divBotao.style.flexDirection = "row";
      segundoPasso.style.backgroundColor = "#38703D";
      numeroDois.style.color = "white";
    }
  }
  function cadastrar() {
    var emailVar = iptEmail.value
    var senhaVar = iptSenha.value
    var nomeVar = iptNome.value
    var cnpjVar = iptCnpj.value
    var telefoneVar = iptTelefone.value
    var razaoSocialVar = iptRazaoSocial.value
    var cepVar = iptCep.value
    var UFVar = iptUF.value
    var cidadeVar = iptCidade.value
    var bairroVar = iptBairro.value
    var ruaVar = iptRua.value
    var complementoVar = iptComplemento.value

    fetch("/usuarios/cadastrar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        // crie um atributo que recebe o valor recuperado aqui
        // Agora vá para o arquivo routes/usuario.js
        emailServer: emailVar,
        senhaServer: senhaVar,
        nomeServer: nomeVar,
        cnpjServer: cnpjVar,
        telefoneServer: telefoneVar,
        razaoSocialServer: razaoSocialVar,
        cepServer: cepVar,
        UFServer: UFVar,
        cidadeServer: cidadeVar,
        bairroServer: bairroVar,
        ruaServer: ruaVar,
        complementoServer: complementoVar
      }),
    })
      .then(function (resposta) {
        console.log("resposta: ", resposta);

        if (resposta.ok) {
          // cardErro.style.display = "block";
          // cardErro.style.border = 'solid 1px #091227';
          // mensagem_erro.innerHTML =
          //   "Cadastro realizado com sucesso! <br> Redirecionando para tela de Login...";

          setTimeout(() => {
            window.location = "login.html";
          }, "2000");

          // limparFormulario();
          // finalizarAguardar();
        } else {
          throw "Houve um erro ao tentar realizar o cadastro!";
        }
      })
      .catch(function (resposta) {
        console.log(`#ERRO: ${resposta}`);
        // finalizarAguardar();
      });

    return false;



    if (cep.length == 8) { erroCEP.style.display = 'none' }
    else {erroCEP.style.display = 'block'
          iptCep.style.borderColor = 'red'    
    }
  }

  function voltar(){
    direito.style.display = "block";
    esquerdo.style.display = "none";
    passoUm.style.display = "block";
    cadastrarse.style.display = "none";
    botaoVoltar.style.display = "none";
    divBotao.style.flexDirection = "column";
    segundoPasso.style.backgroundColor = "white";
    numeroDois.style.color = "black";
  }
</script>